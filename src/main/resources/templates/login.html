<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroTrace - Login</title>
    <link rel="stylesheet" th:href="@{/css/style-auth.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    
    <div class="auth-container">
        <div class="auth-card">
            
            <div class="auth-header">
                <span class="logo-text">AgroTrace</span>
                <h2>Acesse sua conta</h2>
                <p>Bem-vindo de volta! Insira seus dados.</p>
            </div>

            <form id="form-login" class="auth-form">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" name="email" placeholder="seuemail@dominio.com" required>
                </div>
                
                <div class="form-group">
                    <label for="senha">Senha</label>
                    <input type="password" id="senha" name="senha" placeholder="Sua senha" required>
                </div>

                <div class="form-options">
                    <a href="#" class="forgot-password">Esqueceu sua senha?</a>
                </div>

                <button type="submit" class="btn btn-primary">Entrar</button>

               
            </form>

            <div class="auth-footer">
                <p>Não tem uma conta? <a href="cadastro">Cadastre-se</a></p>
            </div>
        </div>
    </div>

      <script>
        const formCadastro = document.getElementById('form-login');

        formCadastro.addEventListener('submit', async(e) => {
            e.preventDefault();

            const dados = Object.fromEntries(new FormData(formCadastro).entries());

            try {
                const resp = await fetch("http://localhost:8080/auth/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dados)
                });

                if (resp.ok) {
                    window.location.href = "/usuario";

                    formCadastro.reset();
                } else {
                    const erro = await resp.text();
                    alert("Erro ao logar: " + erro);
                }
            } catch (err) {
                alert("Erro de conexão com o servidor: " + err.message);
            }
        })
    </script>
</body>
</html>